#
# The following constraints are limitations of the hardware architecture and dataflow
#

architecture_constraints:
  targets:
  # certain buffer only stores certain datatypes
  - target: psum_spad
    type: bypass
    bypass: [Adj, Support]
    keep: [Outputs]
  - target: weights_spad
    type: bypass
    bypass: [Adj, Outputs]
    keep: [Support]
  - target: ifmap_spad
    type: bypass
    bypass: [Support, Outputs]
    keep: [Adj]
  # - target: DummyBuffer
  #   type: bypass
  #   bypass: [Inputs, Outputs, Weights]
  - target: shared_glb
    type: bypass
    bypass: [Support]
    keep: [Adj, Outputs]
  # - target: DummyBuffer
  #   type: spatial
  #   split: 4
  #   permutation: NPQR SCM
  #   factors: N=1 P=1 Q=1 R=1 S=0
  - target: shared_glb
    type: spatial
    permutation: OMN
    factors: N=34 M=1 O=1
  # one ofmap position but of different output channels
  - target: psum_spad
    type: temporal
    permutation: OMN
    factors: N=1 M=1 O=1
  # row stationary -> 1 row at a time
  - target: weights_spad
    type: temporal
    permutation: OMN
    factors: N=1 M=1 O=1
  - target: ifmap_spad
    type: temporal
    permutation: OMN
    factors: N=1 M=1 O=1
  # enforce the hardware limit of the bypassing everything
  # - target: DummyBuffer
  #   type: temporal
  #   factors: N=1 M=1 C=1 P=1 Q=1 R=1 S=1
